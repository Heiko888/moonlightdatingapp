"use client";
import React, { useState, useEffect } from 'react';
import { useRouter, usePathname } from 'next/navigation';
import { 
  Reading
} from '@/types/common.types';
import {
  Container,
  Typography,
  Box,
  Card,
  CardContent,
  Button,
  Grid,
  Paper,
  Chip,
  Dialog,
  DialogTitle,
  DialogContent,
  DialogActions,
  TextField,
  CircularProgress,
  Tabs,
  Tab,
  MenuItem
} from '@mui/material';
import {
  MenuBook,
  ArrowForward
} from '@mui/icons-material';
import AnimatedStars from '../../components/AnimatedStars';
import AccessControl from '../../components/AccessControl';
import { UserSubscription } from '../../lib/subscription/types';
import { SubscriptionService } from '../../lib/subscription/subscriptionService';

interface ReadingExtended extends Reading {
  question: string;
  status: string;
  datingType?: string;
}


const ReadingPage: React.FC = () => {
  const router = useRouter();
  const pathname = usePathname();
  const [userSubscription, setUserSubscription] = useState<UserSubscription | null>(null);
  const [activeTab, setActiveTab] = useState<number>(0);
  // isClient State entfernt f√ºr bessere Performance
  const [readings, setReadings] = useState<ReadingExtended[]>([]);
  const [loading, setLoading] = useState<boolean>(false);
  const [newReadingDialog, setNewReadingDialog] = useState<boolean>(false);
  const [newReadingTitle, setNewReadingTitle] = useState('');
  const [newReadingQuestion, setNewReadingQuestion] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('');
  const [selectedDatingType, setSelectedDatingType] = useState('');

  // Authentifizierung und Subscription pr√ºfen
  useEffect(() => {
    const checkAuth = async () => {
      const token = localStorage.getItem('token');
      const userId = localStorage.getItem('userId');
      
      if (!token || !userId) {
        // Keine Authentifizierung erforderlich - App ist √∂ffentlich
        return;
      }
      
      // isClient State entfernt
      
      // Daten laden
      loadReadings();
      loadUserSubscription();
    };

    checkAuth();
  }, [router]);

  const loadUserSubscription = async () => {
    try {
      const userData = localStorage.getItem('userData');
      if (userData) {
        const user = JSON.parse(userData);
        const subscription = await SubscriptionService.getUserSubscription(user.id);
        setUserSubscription(subscription);
      }
    } catch (error) {
      console.error('Fehler beim Laden des Abonnements:', error);
    }
  };

  const loadReadings = async () => {
    try {
      setLoading(true);
      // SSR-sicherer localStorage Zugriff
      if (typeof window !== 'undefined') {
        const localReadings = JSON.parse(localStorage.getItem('userReadings') || '[]');
        setReadings(localReadings);
      }
    } catch (error) {
      console.error('Fehler beim Laden der Readings:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleTabChange = (event: React.SyntheticEvent, newValue: number) => {
    setActiveTab(newValue);
  };

  const createNewReading = async () => {
    if (!newReadingTitle || !newReadingQuestion) {
      alert('Bitte f√ºlle alle Felder aus!');
      return;
    }

    try {
      // Erstelle Reading-Objekt
      const newReading = {
        id: Date.now().toString(),
        title: newReadingTitle,
        question: newReadingQuestion,
        category: selectedCategory,
        datingType: selectedDatingType,
        content: generateReadingContent(selectedCategory, selectedDatingType, newReadingQuestion),
        created_at: new Date().toISOString(),
        status: 'completed'
      };

      // SSR-sicherer localStorage Zugriff
      if (typeof window !== 'undefined') {
        const existingReadings = JSON.parse(localStorage.getItem('userReadings') || '[]');
        existingReadings.push(newReading);
        localStorage.setItem('userReadings', JSON.stringify(existingReadings));
      }

      // Aktualisiere State
        // setReadings(existingReadings); // Tempor√§r deaktiviert
      setNewReadingDialog(false);
      setNewReadingTitle('');
      setNewReadingQuestion('');
      setSelectedCategory('');
      setSelectedDatingType('');

      alert('Reading erfolgreich erstellt!');
    } catch (error) {
      console.error('Fehler beim Erstellen des Readings:', error);
      alert('Fehler beim Erstellen des Readings');
    }
  };

  const generateReadingContent = (category: string, datingType: string, question: string): string => {
    try {
      // Erweiterte Reading-Struktur basierend auf dem 6/3 Generator Beispiel
      let content = `# üß¨ **${newReadingTitle}**\n\n`;
      content += `**üìÖ Erstellt am:** ${new Date().toLocaleDateString('de-DE')}\n`;
      content += `**üéØ Kategorie:** ${category}\n`;
      content += `**üë§ Human Design Typ:** ${datingType}\n\n`;
      
      content += `## ‚ùì Deine Frage\n\n`;
      content += `*"${question}"*\n\n`;
      
      content += `---\n\n`;
      
      // Erweiterte Human Design Profile
      interface HDProfile {
        type: string;
        strategy: string;
        authority: string;
        profile: string;
        description: string;
        energy: string;
        strengths: string[];
        challenges: string[];
        centers: {
          defined: string[];
          open: string[];
        };
        business: {
          style: string;
          marketing: string;
          sales: string;
          formats: string[];
        };
      }
      
      const hdProfiles: Record<string, HDProfile> = {
        'Generator': {
          type: 'Generator',
          strategy: 'Reagieren',
          authority: 'Sakral-Autorit√§t',
          profile: 'Lebenskraft und Ausdauer',
          description: 'Du bist die Lebenskraft des Planeten. Deine Energie ist konstant und zuverl√§ssig.',
          energy: 'Lebenskraft und Ausdauer',
          strengths: ['Ausdauer', 'Zuverl√§ssigkeit', 'Lebensfreude', 'Arbeitskraft', 'Konstante Energie'],
          challenges: ['Warten lernen', 'Nicht initiieren', 'Sakral-Signale h√∂ren', 'Frustration vermeiden'],
          centers: {
            defined: ['Sakral', 'Wurzel', 'Milz'],
            open: ['Ajna', 'Krone', 'Hals', 'Emotion', 'Ego', 'G-Zentrum']
          },
          business: {
            style: 'Reaktion + Erfahrung + Weisheit',
            marketing: 'Authentizit√§t statt Strategie',
            sales: 'Resonanz statt Push',
            formats: ['Retreats', '1:1-Angebote', 'Storytelling', 'Prozess-basierte Programme']
          }
        },
        'Manifesting Generator': {
          type: 'Manifesting Generator',
          strategy: 'Warten auf die Antwort, dann informieren',
          authority: 'Sakral-Autorit√§t',
          profile: 'Dynamische Lebenskraft',
          description: 'Du bist der dynamische Macher - du kannst sowohl initiieren als auch reagieren.',
          energy: 'Dynamische Lebenskraft',
          strengths: ['Flexibilit√§t', 'Effizienz', 'Multi-Tasking', 'Energie', 'Schnelle Umsetzung'],
          challenges: ['Geduld', 'Kommunikation', 'Priorit√§ten setzen', 'Informieren lernen'],
          centers: {
            defined: ['Sakral', 'Wurzel', 'Milz'],
            open: ['Ajna', 'Krone', 'Hals', 'Emotion', 'Ego', 'G-Zentrum']
          },
          business: {
            style: 'Dynamik + Effizienz + Anpassung',
            marketing: 'Schnelle, effiziente Kommunikation',
            sales: 'Direkte, klare Angebote',
            formats: ['Online-Kurse', 'Schnelle Programme', 'Multi-Format-Angebote']
          }
        },
        'Projector': {
          type: 'Projector',
          strategy: 'Warten auf die Einladung',
          authority: 'Emotionale oder andere Autorit√§t',
          profile: 'F√ºhrung und Beratung',
          description: 'Du bist der nat√ºrliche F√ºhrer und Berater. Du siehst andere klar.',
          energy: 'F√ºhrung und Beratung',
          strengths: ['Weisheit', 'F√ºhrungsqualit√§ten', 'Einsicht', 'Beratung', 'Tiefe Analyse'],
          challenges: ['Warten auf Einladungen', 'Nicht initiieren', 'Erkennung finden', 'Geduld'],
          centers: {
            defined: ['Milz', 'Wurzel'],
            open: ['Sakral', 'Ajna', 'Krone', 'Hals', 'Emotion', 'Ego', 'G-Zentrum']
          },
          business: {
            style: 'Weisheit + F√ºhrung + Beratung',
            marketing: 'Wertvolle Inhalte, die Einladungen schaffen',
            sales: 'Beratung und F√ºhrung',
            formats: ['Coaching', 'Beratung', 'F√ºhrungsprogramme', 'Mentoring']
          }
        },
        'Manifestor': {
          type: 'Manifestor',
          strategy: 'Informieren',
          authority: 'Emotionale oder andere Autorit√§t',
          profile: 'Initiierung und Aktion',
          description: 'Du bist der Initiator. Du bringst Dinge in Bewegung.',
          energy: 'Initiierung und Aktion',
          strengths: ['Initiative', 'Unabh√§ngigkeit', 'Durchsetzungskraft', 'F√ºhrung', 'Innovation'],
          challenges: ['Informieren lernen', 'Frieden schaffen', 'Andere einbeziehen', 'Geduld'],
          centers: {
            defined: ['Hals', 'Wurzel'],
            open: ['Sakral', 'Ajna', 'Krone', 'Milz', 'Emotion', 'Ego', 'G-Zentrum']
          },
          business: {
            style: 'Initiierung + Innovation + F√ºhrung',
            marketing: 'Bahnbrechende Ideen und Innovationen',
            sales: '√úberzeugungskraft und Durchsetzung',
            formats: ['Startups', 'Innovationsprogramme', 'F√ºhrungskr√§fte-Entwicklung']
          }
        },
        'Reflector': {
          type: 'Reflector',
          strategy: 'Warten auf den Mondzyklus',
          authority: 'Mond-Autorit√§t',
          profile: 'Spiegel der Gemeinschaft',
          description: 'Du bist der Spiegel der Gemeinschaft. Du reflektierst die Gesundheit der Gruppe.',
          energy: 'Spiegel der Gemeinschaft',
          strengths: ['Objektivit√§t', 'Gemeinschaftsgef√ºhl', 'Flexibilit√§t', 'Weisheit', 'Spiegelfunktion'],
          challenges: ['Entscheidungen treffen', 'Mondzyklus befolgen', 'Schutz vor Einfl√ºssen', 'Geduld'],
          centers: {
            defined: [],
            open: ['Sakral', 'Ajna', 'Krone', 'Hals', 'Milz', 'Emotion', 'Ego', 'G-Zentrum', 'Wurzel']
          },
          business: {
            style: 'Spiegelung + Gemeinschaft + Weisheit',
            marketing: 'Gemeinschaftsorientierte Inhalte',
            sales: 'Gemeinschaftsbildung und Verbindung',
            formats: ['Community-Programme', 'Gruppen-Coaching', 'Gemeinschafts-Events']
          }
        }
      };
      
      const userProfile = hdProfiles[datingType] || hdProfiles['Generator'];
      
      // Vollst√§ndiges Human Design Profil
      content += `## üß¨ **${userProfile.type} mit ${userProfile.authority}**\n\n`;
      content += `**Typ:** ${userProfile.type}\n`;
      content += `**Strategie:** ${userProfile.strategy}\n`;
      content += `**Autorit√§t:** ${userProfile.authority}\n`;
      content += `**Profil:** ${userProfile.profile}\n\n`;
      
      content += `### üîã **Typ: ${userProfile.type}**\n\n`;
      content += `${userProfile.description}\n\n`;
      
      content += `**Was dich st√§rkt:**\n\n`;
      userProfile.strengths.forEach((strength: string) => {
        content += `* ${strength}\n`;
      });
      content += `\n`;
      
      content += `**Deine Herausforderungen:**\n\n`;
      userProfile.challenges.forEach((challenge: string) => {
        content += `* ${challenge}\n`;
      });
      content += `\n`;
      
      content += `### üåä **Autorit√§t: ${userProfile.authority}**\n\n`;
      if (userProfile.authority === 'Sakral-Autorit√§t') {
        content += `Du triffst Entscheidungen √ºber dein Bauchgef√ºhl. Dein Sakralzentrum gibt dir klare Ja-/Nein-Antworten.\n\n`;
        content += `**Entscheidungsstil:**\n`;
        content += `* H√∂re auf deine Sakral-Antworten (Ah-hah, Uh-uh)\n`;
        content += `* Vertraue deinem ersten Gef√ºhl\n`;
        content += `* Warte auf die richtige Frage\n`;
        content += `* Reagiere spontan auf das, was dich begeistert\n\n`;
      } else if (userProfile.authority === 'Emotionale oder andere Autorit√§t') {
        content += `Du triffst Entscheidungen nicht spontan ‚Äì du brauchst Zeit, um durch deine emotionale Welle zu gehen.\n\n`;
        content += `**Entscheidungsstil:**\n`;
        content += `* Warte, bis du emotional ausgeglichen bist\n`;
        content += `* Beobachte deine Hoch- und Tiefphasen\n`;
        content += `* Triff keine Entscheidungen in Euphorie oder Verzweiflung\n`;
        content += `* Gib dir mehrere Tage Bedenkzeit bei gro√üen Entscheidungen\n\n`;
      } else if (userProfile.authority === 'Mond-Autorit√§t') {
        content += `Du brauchst einen vollen Mondzyklus (28 Tage), um wichtige Entscheidungen zu treffen.\n\n`;
        content += `**Entscheidungsstil:**\n`;
        content += `* Warte auf den Mondzyklus\n`;
        content += `* Sammle Informationen √ºber 28 Tage\n`;
        content += `* Beobachte deine Reaktionen auf verschiedene Optionen\n`;
        content += `* Vertraue auf die Klarheit nach dem Zyklus\n\n`;
      }
      
      content += `### üåÄ **Zentren**\n\n`;
      content += `**Definiert:**\n`;
      userProfile.centers.defined.forEach((center: string) => {
        content += `* **${center}**: Stabile, zuverl√§ssige Energie\n`;
      });
      content += `\n`;
      
      content += `**Offen:**\n`;
      userProfile.centers.open.forEach((center: string) => {
        content += `* **${center}**: Empf√§nglich f√ºr Einfl√ºsse - hier kannst du wachsen\n`;
      });
      content += `\n`;
      
      content += `---\n\n`;
      
      // Business & Marketing Bereich (falls relevant)
      if (category === 'business' || category === 'career' || category === 'leadership') {
        content += `## üî• **Business & Marketing als ${userProfile.type}**\n\n`;
        content += `### üß≠ **Grundenergie im Business: ${userProfile.business.style}**\n\n`;
        content += `### üìà **Dein nat√ºrlicher Marketingstil: ${userProfile.business.marketing}**\n\n`;
        content += `### üí¨ **Verkaufsenergie: ${userProfile.business.sales}**\n\n`;
        content += `### üõ†Ô∏è **Konkrete Businessformate, die zu dir passen:**\n\n`;
        userProfile.business.formats.forEach((format: string) => {
          content += `| üîπ ${format} | Deine nat√ºrliche St√§rke in diesem Bereich |\n`;
        });
        content += `\n`;
        
        content += `### üß† **Dein ideales Marketingmantra:**\n\n`;
        content += `> **"Ich bin kein Produkt. Ich bin Erfahrung, Reife und Echtheit."**\n`;
        content += `> **"Ich muss nicht verkaufen ‚Äì ich muss sichtbar sein in meinem Prozess."**\n\n`;
        
        content += `### üö´ **Warnsignale, dass du dich im Business verlierst:**\n\n`;
        content += `* Du machst etwas, nur weil ‚Äûman das so macht"\n`;
        content += `* Du bist im Launch, f√ºhlst dich aber leer\n`;
        content += `* Du passt dich an den Markt an und verlierst deine Stimme\n`;
        content += `* Du verbirgst Fehler ‚Äì obwohl sie deine St√§rke w√§ren\n\n`;
        
        content += `---\n\n`;
      }
      
      // Kategorie-spezifische Bereiche
      content += `## üîç **Detaillierte Bereiche**\n\n`;
      
      interface DetailedArea {
        title: string;
        areas: Array<{
          name: string;
          content: string;
        }>;
      }
      
      const detailedAreas: Record<string, DetailedArea> = {
        'first-date': {
          title: 'üíï First Date Bereich',
          areas: [
            {
              name: 'Ort & Aktivit√§t',
              content: `W√§hle einen Ort, der zu deiner ${userProfile.type}-Energie passt. ${userProfile.type === 'Generator' ? 'Generatoren lieben Aktivit√§t und Bewegung.' : userProfile.type === 'Projector' ? 'Projectors bevorzugen ruhige Gespr√§che und tiefe Verbindung.' : userProfile.type === 'Manifestor' ? 'Manifestors brauchen Raum f√ºr Initiative und F√ºhrung.' : 'Reflectors brauchen Zeit und Raum zum Spiegeln.'}`
            },
            {
              name: 'Kommunikation',
              content: `Sei authentisch und folge deiner inneren Autorit√§t. ${userProfile.type === 'Generator' ? 'Generatoren warten auf Fragen und reagieren spontan.' : userProfile.type === 'Projector' ? 'Projectors teilen Weisheit nur bei Einladung.' : userProfile.type === 'Manifestor' ? 'Manifestors informieren √ºber ihre Pl√§ne.' : 'Reflectors brauchen Zeit f√ºr ihre Antworten.'}`
            },
            {
              name: 'Energie-Management',
              content: 'Achte auf die Energie deines Dates. Manche brauchen mehr Raum, andere mehr N√§he. Respektiere die unterschiedlichen Bed√ºrfnisse und folge deiner eigenen Energie.'
            },
            {
              name: 'Nach dem Date',
              content: 'Reflektiere √ºber deine Energie und Reaktionen. Was hat sich gut angef√ºhlt? Was war herausfordernd? Nutze diese Erkenntnisse f√ºr zuk√ºnftige Dates.'
            }
          ]
        },
        'relationship': {
          title: 'üíë Beziehungs-Bereich',
          areas: [
            {
              name: 'Energie-Dynamik',
              content: `Verstehe die Energie-Dynamik zwischen euch. Als ${userProfile.type} bringst du ${userProfile.energy} in die Beziehung. Wie erg√§nzen sich eure Energien?`
            },
            {
              name: 'Kommunikationsstrategien',
              content: `Respektiere die unterschiedlichen Strategien. Als ${userProfile.type} folgst du der Strategie "${userProfile.strategy}". Kommuniziere das klar mit deinem Partner.`
            },
            {
              name: 'Gemeinsame Channels',
              content: 'Nutze eure gemeinsamen Channels f√ºr tiefere Verbindung. Diese sind eure nat√ºrlichen Verbindungspunkte und zeigen eure gemeinsamen Talente.'
            },
            {
              name: 'Wachstum zusammen',
              content: 'Arbeite an euren individuellen Wachstumsbereichen. Unterst√ºtzt euch gegenseitig beim Lernen und Wachsen, besonders in den offenen Centers.'
            }
          ]
        },
        'communication': {
          title: 'üí¨ Kommunikations-Bereich',
          areas: [
            {
              name: `${userProfile.type} Kommunikation`,
              content: `${userProfile.type === 'Generator' ? 'Warte auf die richtige Frage, bevor du antwortest. Deine Sakral-Autorit√§t zeigt dir, wann du wirklich antworten solltest.' : userProfile.type === 'Projector' ? 'Teile deine Weisheit, aber nur wenn du eingeladen wirst. Deine Einsichten sind wertvoll, aber nur wenn sie gew√ºnscht sind.' : userProfile.type === 'Manifestor' ? 'Informiere andere √ºber deine Pl√§ne. Kommunikation ist der Schl√ºssel zu friedlichen Beziehungen.' : 'Nimm dir Zeit f√ºr wichtige Entscheidungen. Der Mondzyklus gibt dir die Klarheit, die du brauchst.'}`
            },
            {
              name: 'Authentische Kommunikation',
              content: 'Kommuniziere aus deiner wahren Natur heraus. Sei ehrlich √ºber deine Bed√ºrfnisse und Grenzen.'
            },
            {
              name: 'Energie-basierte Kommunikation',
              content: 'Achte auf die Energie deines Gespr√§chspartners. Verschiedene Typen brauchen verschiedene Arten der Kommunikation.'
            },
            {
              name: 'Konfliktl√∂sung',
              content: 'Nutze deine Human Design Weisheit f√ºr bessere Konfliktl√∂sung. Verstehe die Energie des anderen und finde gemeinsame L√∂sungen.'
            }
          ]
        },
        'career': {
          title: 'üíº Karriere-Bereich',
          areas: [
            {
              name: 'Energie & Arbeit',
              content: `Finde Arbeit, die zu deiner ${userProfile.type}-Energie passt. ${userProfile.type === 'Generator' ? 'Generatoren brauchen befriedigende Arbeit, die sie energetisiert.' : userProfile.type === 'Projector' ? 'Projectors suchen Anerkennung und F√ºhrungsrollen.' : userProfile.type === 'Manifestor' ? 'Manifestors brauchen Freiheit und Initiative.' : 'Reflectors brauchen vielf√§ltige Erfahrungen.'}`
            },
            {
              name: 'Strategie im Beruf',
              content: `Wende deine Strategie "${userProfile.strategy}" auch im Beruf an. Warte auf die richtigen Gelegenheiten und folge deiner Autorit√§t.`
            },
            {
              name: 'Wachstum & Entwicklung',
              content: 'Nutze deine offenen Centers f√ºr berufliches Wachstum. Sie zeigen dir, wo du lernen und dich entwickeln kannst.'
            },
            {
              name: 'Zusammenarbeit',
              content: 'Verstehe die Energie deiner Kollegen. Verschiedene Typen brauchen verschiedene Arten der Zusammenarbeit und F√ºhrung.'
            }
          ]
        },
        'health': {
          title: 'üå± Gesundheits-Bereich',
          areas: [
            {
              name: 'Energie-Management',
              content: `Achte auf deine Energie. Als ${userProfile.type} brauchst du ${userProfile.type === 'Generator' ? 'Bewegung und befriedigende Aktivit√§ten.' : userProfile.type === 'Projector' ? 'Ruhe und Anerkennung.' : userProfile.type === 'Manifestor' ? 'Freiheit und Initiative.' : 'Zeit und Raum zum Spiegeln.'}`
            },
            {
              name: 'Ern√§hrung',
              content: 'H√∂re auf deine innere Autorit√§t bei der Ern√§hrung. Dein K√∂rper wei√ü, was er braucht, wenn du ihm zuh√∂rst.'
            },
            {
              name: 'Stress-Management',
              content: 'Verstehe deine Stress-Signale. Offene Centers zeigen dir, wo du anf√§llig f√ºr Stress bist und wie du dich sch√ºtzen kannst.'
            },
            {
              name: 'Wohlbefinden',
              content: `Folge deiner Strategie "${userProfile.strategy}" f√ºr besseres Wohlbefinden. Sie ist dein Kompass f√ºr ein gesundes Leben.`
            }
          ]
        },
        'marketing': {
          title: 'üìà Marketing & Verkauf',
          areas: [
            {
              name: 'Authentisches Marketing',
              content: `Als ${userProfile.type} funktioniert f√ºr dich ${userProfile.business.marketing}. Zeige deine echte Pers√∂nlichkeit und teile deine Erfahrungen.`
            },
            {
              name: 'Verkaufsstrategie',
              content: `Deine Verkaufsenergie ist ${userProfile.business.sales}. Nutze deine nat√ºrlichen St√§rken f√ºr authentische Verkaufsgespr√§che.`
            },
            {
              name: 'Content-Erstellung',
              content: 'Erstelle Inhalte, die zu deiner Energie passen. Teile deine Geschichte und deine Erfahrungen authentisch.'
            },
            {
              name: 'Kundenbeziehungen',
              content: 'Baue echte Beziehungen zu deinen Kunden auf. Deine Human Design Weisheit hilft dir, die richtigen Menschen anzusprechen.'
            }
          ]
        },
        'entrepreneurship': {
          title: 'üí° Unternehmertum',
          areas: [
            {
              name: 'Gesch√§ftsidee entwickeln',
              content: `Als ${userProfile.type} bringst du ${userProfile.energy} in dein Unternehmen. Nutze deine nat√ºrlichen Talente f√ºr deine Gesch√§ftsidee.`
            },
            {
              name: 'Strategie & Planung',
              content: `Folge deiner Strategie "${userProfile.strategy}" auch im Business. Plane nicht zu detailliert, sondern reagiere auf Gelegenheiten.`
            },
            {
              name: 'Team aufbauen',
              content: 'Baue ein Team auf, das deine Energie erg√§nzt. Verstehe die verschiedenen Human Design Typen f√ºr bessere Zusammenarbeit.'
            },
            {
              name: 'Wachstum & Skalierung',
              content: 'Skaliere dein Business im Einklang mit deiner Energie. Erzwinge kein Wachstum, das nicht zu dir passt.'
            }
          ]
        },
        'teamwork': {
          title: 'üë• Teamarbeit',
          areas: [
            {
              name: 'Team-Dynamik verstehen',
              content: `Als ${userProfile.type} bringst du ${userProfile.energy} ins Team. Verstehe die Energie deiner Teammitglieder f√ºr bessere Zusammenarbeit.`
            },
            {
              name: 'Kommunikation im Team',
              content: 'Nutze deine Human Design Weisheit f√ºr bessere Teamkommunikation. Verschiedene Typen brauchen verschiedene Kommunikationsstile.'
            },
            {
              name: 'Konflikte l√∂sen',
              content: 'L√∂se Teamkonflikte durch Verst√§ndnis der verschiedenen Energien. Jeder Typ hat andere Bed√ºrfnisse und Reaktionsweisen.'
            },
            {
              name: 'Produktivit√§t steigern',
              content: 'Steigere die Teamproduktivit√§t durch optimale Energieverteilung. Nutze die St√§rken jedes Teammitglieds.'
            }
          ]
        },
        'job-search': {
          title: 'üîç Jobsuche',
          areas: [
            {
              name: 'Richtige Jobs finden',
              content: `Suche Jobs, die zu deiner ${userProfile.type}-Energie passen. ${userProfile.type === 'Generator' ? 'Generatoren brauchen befriedigende Arbeit.' : userProfile.type === 'Projector' ? 'Projectors suchen Anerkennung und F√ºhrung.' : userProfile.type === 'Manifestor' ? 'Manifestors brauchen Freiheit und Initiative.' : 'Reflectors brauchen vielf√§ltige Erfahrungen.'}`
            },
            {
              name: 'Bewerbungsstrategie',
              content: `Nutze deine Strategie "${userProfile.strategy}" auch bei der Jobsuche. Warte auf die richtigen Gelegenheiten und folge deiner Autorit√§t.`
            },
            {
              name: 'Vorstellungsgespr√§che',
              content: 'Sei authentisch in Vorstellungsgespr√§chen. Zeige deine echte Pers√∂nlichkeit und deine Human Design St√§rken.'
            },
            {
              name: 'Networking',
              content: 'Baue echte berufliche Beziehungen auf. Nutze deine Human Design Weisheit f√ºr authentisches Networking.'
            }
          ]
        },
        'skills': {
          title: 'üéØ F√§higkeiten entwickeln',
          areas: [
            {
              name: 'Nat√ºrliche Talente nutzen',
              content: `Entwickle deine nat√ºrlichen ${userProfile.type}-Talente. Nutze deine definierten Centers f√ºr deine St√§rken.`
            },
            {
              name: 'Wachstumsbereiche',
              content: 'Arbeite an deinen offenen Centers f√ºr pers√∂nliches Wachstum. Sie zeigen dir, wo du lernen und dich entwickeln kannst.'
            },
            {
              name: 'Lernstrategien',
              content: `Lerne im Einklang mit deiner Strategie "${userProfile.strategy}". Finde Lernmethoden, die zu deiner Energie passen.`
            },
            {
              name: 'F√§higkeiten anwenden',
              content: 'Wende deine F√§higkeiten authentisch an. Nutze deine Human Design Weisheit f√ºr bessere Anwendung deiner Talente.'
            }
          ]
        },
        'networking': {
          title: 'ü§ù Networking',
          areas: [
            {
              name: 'Authentische Verbindungen',
              content: `Baue echte Verbindungen auf, die zu deiner ${userProfile.type}-Energie passen. Sei authentisch in deinen Beziehungen.`
            },
            {
              name: 'Networking-Strategie',
              content: `Nutze deine Strategie "${userProfile.strategy}" auch beim Networking. Warte auf die richtigen Gelegenheiten und Menschen.`
            },
            {
              name: 'Wertvolle Beziehungen',
              content: 'Baue wertvolle berufliche Beziehungen auf. Verstehe die verschiedenen Human Design Typen f√ºr bessere Verbindungen.'
            },
            {
              name: 'Gegenseitige Unterst√ºtzung',
              content: 'Unterst√ºtze andere und lass dich unterst√ºtzen. Nutze deine Human Design Weisheit f√ºr gegenseitige Hilfe.'
            }
          ]
        },
        'team-management': {
          title: 'üë• Team-Management',
          areas: [
            {
              name: 'F√ºhrungsstil entwickeln',
              content: `Als ${userProfile.type} entwickle einen F√ºhrungsstil, der zu deiner Energie passt. Nutze deine nat√ºrlichen F√ºhrungsqualit√§ten.`
            },
            {
              name: 'Team-Energie verstehen',
              content: 'Verstehe die Energie deines Teams. Verschiedene Human Design Typen brauchen verschiedene F√ºhrungsans√§tze.'
            },
            {
              name: 'Motivation & Engagement',
              content: 'Motiviere dein Team durch Verst√§ndnis ihrer individuellen Bed√ºrfnisse. Jeder Typ hat andere Motivationsfaktoren.'
            },
            {
              name: 'Performance-Management',
              content: 'F√ºhre Performance-Gespr√§che im Einklang mit Human Design Prinzipien. Verstehe die St√§rken und Wachstumsbereiche jedes Teammitglieds.'
            }
          ]
        },
        'decision-making': {
          title: 'üéØ Entscheidungsfindung',
          areas: [
            {
              name: 'Entscheidungsprozess',
              content: `Nutze deine ${userProfile.authority} f√ºr bessere Entscheidungen. Folge deiner inneren Autorit√§t bei wichtigen Entscheidungen.`
            },
            {
              name: 'Team-Entscheidungen',
              content: 'F√ºhre Team-Entscheidungen durch Verst√§ndnis der verschiedenen Autorit√§ten. Jeder Typ hat andere Entscheidungsprozesse.'
            },
            {
              name: 'Strategische Planung',
              content: `Plane strategisch im Einklang mit deiner Strategie "${userProfile.strategy}". Erzwinge keine Entscheidungen, die nicht zu dir passen.`
            },
            {
              name: 'Risikobewertung',
              content: 'Bewerte Risiken durch deine Human Design Weisheit. Nutze deine nat√ºrliche Intuition f√ºr bessere Entscheidungen.'
            }
          ]
        }
      };
      
      const selectedArea = detailedAreas[category] || detailedAreas['first-date'];
      
      content += `### ${selectedArea.title}\n\n`;
      
      selectedArea.areas.forEach((area, index: number) => {
        content += `#### ${index + 1}. ${area.name}\n\n`;
        content += `${area.content}\n\n`;
      });
      
      content += `---\n\n`;
      
      // Praktische √úbungen
      content += `## üéØ **Praktische √úbungen**\n\n`;
      content += `### Diese Woche:\n\n`;
      content += `‚Ä¢ **Tag 1-2:** Beobachte deine Energie und Reaktionen\n`;
      content += `‚Ä¢ **Tag 3-4:** Experimentiere mit deiner Strategie "${userProfile.strategy}"\n`;
      content += `‚Ä¢ **Tag 5-6:** Arbeite an einem Wachstumsbereich\n`;
      content += `‚Ä¢ **Tag 7:** Reflektiere √ºber deine Erfahrungen\n\n`;
      
      content += `### N√§chste Schritte:\n\n`;
      content += `‚Ä¢ Vertraue auf deine innere Weisheit\n`;
      content += `‚Ä¢ Sei geduldig mit dir selbst und dem Prozess\n`;
      content += `‚Ä¢ Dokumentiere deine Erkenntnisse\n`;
      content += `‚Ä¢ Teile deine Erfahrungen mit anderen\n\n`;
      
      content += `---\n\n`;
      content += `*Dieses Reading wurde basierend auf Human Design Prinzipien erstellt und ist eine pers√∂nliche Interpretation deiner energetischen Struktur.*\n\n`;
      content += `*F√ºr ein pers√∂nliches Reading wende dich an einen zertifizierten Human Design Berater.*`;
      
      return content;
    } catch (error) {
      console.error('Fehler in generateReadingContent:', error);
      return `üìñ **${newReadingTitle}**\n\n**Deine Frage:** ${question}\n\n**‚ú® Allgemeine Human Design Insights:**\n\nBasierend auf deiner Frage und deinem Human Design hier einige wertvolle Erkenntnisse:\n\n‚Ä¢ Folge immer deiner inneren Autorit√§t bei wichtigen Entscheidungen\n‚Ä¢ Nutze deine Strategie als Kompass f√ºr dein Leben\n‚Ä¢ Arbeite an deinen offenen Centers f√ºr pers√∂nliches Wachstum\n‚Ä¢ Verstehe deine Definition f√ºr bessere Beziehungen\n\n**üéØ N√§chste Schritte:**\n‚Ä¢ Beobachte deine Energie und Reaktionen in den n√§chsten Tagen\n‚Ä¢ Experimentiere mit den gegebenen Tipps\n‚Ä¢ Vertraue auf deine innere Weisheit\n‚Ä¢ Sei geduldig mit dir selbst und dem Prozess\n\n*Dieses Reading wurde basierend auf Human Design Prinzipien erstellt.*`;
    }
  };

  // isClient Check entfernt - Seite l√§dt sofort

  return (
    <AccessControl 
      path={pathname} 
      userSubscription={userSubscription}
      onUpgrade={() => router.push('/pricing')}
    >
    <Box sx={{ 
      minHeight: '100vh',
      background: 'linear-gradient(135deg, #0F0F23 0%, #1A1A2E 100%)',
      position: 'relative',
      overflow: 'hidden'
    }}>
      <AnimatedStars />
      
      <Container maxWidth="xl" sx={{ position: 'relative', zIndex: 1, py: 4 }}>
        {/* Header */}
        <div>
          <Box textAlign="center" mb={6}>
            <Typography 
              variant="h2" 
              component="h1" 
              sx={{ 
                background: 'linear-gradient(45deg, #8b5cf6, #a855f7, #c084fc)',
                backgroundClip: 'text',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                fontWeight: 'bold',
                mb: 3
              }}
            >
              üìñ Dein pers√∂nliches Reading
            </Typography>
            
            <Typography 
              variant="h5" 
              sx={{ 
                color: 'rgba(255,255,255,0.9)',
                maxWidth: '800px',
                mx: 'auto',
                mb: 4,
                lineHeight: 1.6
              }}
            >
              Tauche ein in die Welt deiner Energie, deines Bewusstseins und deiner einzigartigen Ausstrahlung.
            </Typography>

            <Typography 
              variant="body1" 
              sx={{ 
                color: 'rgba(255,255,255,0.8)',
                maxWidth: '900px',
                mx: 'auto',
                mb: 4,
                lineHeight: 1.7,
                fontSize: '1.1rem'
              }}
            >
              Ein Reading ist mehr als nur eine Analyse ‚Äì es ist ein Blick in dein energetisches Potenzial. 
              Gemeinsam entdecken wir, wie deine Energie flie√üt, welche St√§rken in dir verborgen liegen 
              und wo Blockaden dich vielleicht noch zur√ºckhalten.
            </Typography>

            <Typography 
              variant="body1" 
              sx={{ 
                color: 'rgba(255,255,255,0.8)',
                maxWidth: '900px',
                mx: 'auto',
                mb: 4,
                lineHeight: 1.7,
                fontSize: '1.1rem'
              }}
            >
              Ob Business, Beziehungen oder pers√∂nliche Entwicklung:<br/>
              Ein Reading schenkt dir Klarheit, Orientierung und ein tiefes Verst√§ndnis daf√ºr, 
              <strong> wer du wirklich bist</strong> und wie du dein Leben im Einklang mit deiner inneren Wahrheit gestalten kannst.
            </Typography>
          </Box>
        </div>

        {/* Main Content */}
        <div>
          <Paper 
            elevation={3} 
            sx={{ 
              borderRadius: 3,
              background: 'rgba(255,255,255,0.05)',
              backdropFilter: 'blur(10px)',
              border: '1px solid rgba(255,255,255,0.1)',
              overflow: 'hidden'
            }}
          >
            <Tabs
              value={activeTab}
              onChange={handleTabChange}
              variant="fullWidth"
              sx={{
                '& .MuiTab-root': {
                  color: 'rgba(255,255,255,0.7)',
                  fontWeight: 'bold',
                  textTransform: 'none',
                  fontSize: '1.1rem',
                  py: 2,
                  '&.Mui-selected': {
                    color: '#8b5cf6',
                    background: 'rgba(139, 92, 246, 0.1)',
                  },
                },
                '& .MuiTabs-indicator': {
                  backgroundColor: '#8b5cf6',
                },
              }}
            >
              <Tab label="üìö Meine Readings" />
              <Tab label="‚ú® Neues Reading" />
              <Tab label="üéØ Empfehlungen" />
            </Tabs>

            <Box sx={{ p: 4 }}>
              {activeTab === 0 && (
                <Box>
                  <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 3 }}>
                    <Typography variant="h5" sx={{ color: 'white', fontWeight: 600 }}>
                      Deine Readings
                    </Typography>
                    <Button
                      variant="contained"
                      startIcon={<ArrowForward />}
                      onClick={() => setNewReadingDialog(true)}
                      sx={{
                        background: 'linear-gradient(45deg, #8b5cf6, #a855f7)',
                        '&:hover': {
                          background: 'linear-gradient(45deg, #7c3aed, #9333ea)',
                        }
                      }}
                    >
                      Neues Reading
                    </Button>
                  </Box>

                  {loading ? (
                    <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>
                      <CircularProgress />
                    </Box>
                  ) : readings.length === 0 ? (
                    <Box sx={{ textAlign: 'center', py: 6 }}>
                      <MenuBook sx={{ fontSize: 64, color: 'rgba(255,255,255,0.3)', mb: 2 }} />
                      <Typography variant="h6" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                        Noch keine Readings vorhanden
                      </Typography>
                      <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.5)' }}>
                        Erstelle dein erstes Reading und entdecke dein energetisches Potenzial
                      </Typography>
                    </Box>
                  ) : (
                    <Grid container spacing={3}>
                      {readings.map((reading) => (
                        <Grid item xs={12} md={6} lg={4} key={reading.id}>
                          <Card
                            sx={{
                              background: 'rgba(255,255,255,0.05)',
                              border: '1px solid rgba(255,255,255,0.1)',
                              borderRadius: 2,
                              transition: 'all 0.3s ease',
                              '&:hover': {
                                transform: 'translateY(-4px)',
                                boxShadow: '0 8px 25px rgba(139, 92, 246, 0.3)',
                              }
                            }}
                          >
                            <CardContent>
                              <Typography variant="h6" sx={{ color: 'white', mb: 1, fontWeight: 600 }}>
                                {reading.title}
                              </Typography>
                              <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                                {reading.question}
                              </Typography>
                              <Box sx={{ display: 'flex', gap: 1, mb: 2, flexWrap: 'wrap' }}>
                                <Chip
                                  label={reading.status === 'completed' ? 'Abgeschlossen' : 'In Bearbeitung'}
                                  size="small"
                                  sx={{
                                    background: reading.status === 'completed' ? '#10b981' : '#f59e0b',
                                    color: 'white',
                                    fontWeight: 500
                                  }}
                                />
                                {reading.category && (
                                  <Chip
                                    label={reading.category === 'dating' ? 'üíï Dating' : 
                                           reading.category === 'business' ? 'üíº Business' : 
                                           reading.category === 'personal' ? '‚ú® Pers√∂nlich' : 'üåü Allgemein'}
                                    size="small"
                                    sx={{
                                      background: 'rgba(139, 92, 246, 0.2)',
                                      color: '#8b5cf6',
                                      fontWeight: 500
                                    }}
                                  />
                                )}
                              </Box>
                              <Button
                                variant="outlined"
                                size="small"
                                onClick={() => {
                                  // Zeige Reading-Inhalt in einem Dialog
                                  alert(reading.content || 'Kein Inhalt verf√ºgbar');
                                }}
                                sx={{
                                  borderColor: 'rgba(255,255,255,0.3)',
                                  color: 'white',
                                  '&:hover': {
                                    borderColor: '#8b5cf6',
                                    backgroundColor: 'rgba(139, 92, 246, 0.1)'
                                  }
                                }}
                              >
                                Reading anzeigen
                              </Button>
                            </CardContent>
                          </Card>
                        </Grid>
                      ))}
                    </Grid>
                  )}
                </Box>
              )}

              {activeTab === 1 && (
                <Box>
                  <Typography variant="h5" sx={{ color: 'white', fontWeight: 600, mb: 3 }}>
                    Neues Reading erstellen
                  </Typography>
                  <Typography variant="body1" sx={{ color: 'rgba(255,255,255,0.8)', mb: 4 }}>
                    Erstelle ein neues Reading und erhalte tiefe Einblicke in dein Human Design.
                  </Typography>
                  
                  <Button
                    variant="contained"
                    size="large"
                    onClick={() => setNewReadingDialog(true)}
                    sx={{
                      background: 'linear-gradient(45deg, #8b5cf6, #a855f7)',
                      py: 2,
                      px: 4,
                      fontSize: '1.1rem',
                      '&:hover': {
                        background: 'linear-gradient(45deg, #7c3aed, #9333ea)',
                      }
                    }}
                  >
                    Reading starten
                  </Button>
                </Box>
              )}

              {activeTab === 2 && (
                <Box>
                  <Typography variant="h5" sx={{ color: 'white', fontWeight: 600, mb: 3 }}>
                    Empfohlene Readings
                  </Typography>
                  <Typography variant="body1" sx={{ color: 'rgba(255,255,255,0.8)', mb: 4 }}>
                    Basierend auf deinem Human Design empfehlen wir dir diese Readings:
                  </Typography>
                  
                  <Grid container spacing={3}>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            üíº Business & Marketing
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Entdecke deinen nat√ºrlichen Business-Stil und Marketing-Ansatz basierend auf deinem Human Design.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('business');
                              setSelectedDatingType('career');
                              setNewReadingDialog(true);
                            }}
                          >
                            Business-Reading
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            üëë Leadership & Management
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Verstehe deine nat√ºrlichen F√ºhrungsqualit√§ten und wie du Teams optimal leitest.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('leadership');
                              setSelectedDatingType('career');
                              setNewReadingDialog(true);
                            }}
                          >
                            Leadership-Reading
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            ‚ù§Ô∏è Beziehungen & Liebe
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Verstehe deine Beziehungsdynamiken und finde dein energetisches Match.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('dating');
                              setSelectedDatingType('relationship');
                              setNewReadingDialog(true);
                            }}
                          >
                            Beziehungs-Reading
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            ü•∞ Erstes Date
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Authentische Dating-Tipps basierend auf deinem Human Design f√ºr den perfekten ersten Eindruck.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('dating');
                              setSelectedDatingType('first-date');
                              setNewReadingDialog(true);
                            }}
                          >
                            Dating-Tipps
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            üí¨ Kommunikation
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Lerne, wie du mit deinem energetischen Typ am besten kommunizierst.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('communication');
                              setSelectedDatingType('communication');
                              setNewReadingDialog(true);
                            }}
                          >
                            Kommunikations-Reading
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                    <Grid item xs={12} md={6}>
                      <Card sx={{ background: 'rgba(255,255,255,0.05)', border: '1px solid rgba(255,255,255,0.1)' }}>
                        <CardContent>
                          <Typography variant="h6" sx={{ color: 'white', mb: 2 }}>
                            üå± Gesundheit & Wohlbefinden
                          </Typography>
                          <Typography variant="body2" sx={{ color: 'rgba(255,255,255,0.7)', mb: 2 }}>
                            Entdecke, wie du deine Energie optimal nutzt und dein Wohlbefinden steigerst.
                          </Typography>
                          <Button 
                            variant="outlined" 
                            size="small"
                            onClick={() => {
                              setSelectedCategory('health');
                              setSelectedDatingType('health');
                              setNewReadingDialog(true);
                            }}
                          >
                            Gesundheits-Reading
                          </Button>
                        </CardContent>
                      </Card>
                    </Grid>
                  </Grid>
                </Box>
              )}
            </Box>
          </Paper>
        </div>
      </Container>

      {/* New Reading Dialog */}
      <Dialog
        open={newReadingDialog}
        onClose={() => setNewReadingDialog(false)}
        maxWidth="md"
        fullWidth
        PaperProps={{
          sx: {
            background: 'rgba(15, 15, 35, 0.95)',
            backdropFilter: 'blur(10px)',
            border: '1px solid rgba(255,255,255,0.1)',
            borderRadius: 3
          }
        }}
      >
        <DialogTitle sx={{ color: 'white', fontWeight: 600 }}>
          Neues Reading erstellen
        </DialogTitle>
        <DialogContent>
          <TextField
            autoFocus
            margin="dense"
            label="Titel des Readings"
            fullWidth
            variant="outlined"
            value={newReadingTitle}
            onChange={(e) => setNewReadingTitle(e.target.value)}
            sx={{
              mb: 3,
              '& .MuiOutlinedInput-root': {
                color: 'white',
                '& fieldset': {
                  borderColor: 'rgba(255,255,255,0.3)',
                },
                '&:hover fieldset': {
                  borderColor: 'rgba(255,255,255,0.5)',
                },
                '&.Mui-focused fieldset': {
                  borderColor: '#8b5cf6',
                },
              },
              '& .MuiInputLabel-root': {
                color: 'rgba(255,255,255,0.7)',
                '&.Mui-focused': {
                  color: '#8b5cf6',
                },
              },
            }}
          />
          
          <TextField
            select
            margin="dense"
            label="Kategorie"
            fullWidth
            variant="outlined"
            value={selectedCategory}
            onChange={(e) => setSelectedCategory(e.target.value)}
            sx={{
              mb: 3,
              '& .MuiOutlinedInput-root': {
                color: 'white',
                '& fieldset': {
                  borderColor: 'rgba(255,255,255,0.3)',
                },
                '&:hover fieldset': {
                  borderColor: 'rgba(255,255,255,0.5)',
                },
                '&.Mui-focused fieldset': {
                  borderColor: '#8b5cf6',
                },
              },
              '& .MuiInputLabel-root': {
                color: 'rgba(255,255,255,0.7)',
                '&.Mui-focused': {
                  color: '#8b5cf6',
                },
              },
            }}
          >
            <MenuItem value="dating">üíï Dating & Beziehungen</MenuItem>
            <MenuItem value="business">üíº Business & Karriere</MenuItem>
            <MenuItem value="career">üöÄ Karriere & F√ºhrung</MenuItem>
            <MenuItem value="leadership">üëë Leadership & Management</MenuItem>
            <MenuItem value="communication">üí¨ Kommunikation</MenuItem>
            <MenuItem value="health">üå± Gesundheit & Wohlbefinden</MenuItem>
            <MenuItem value="personal">‚ú® Pers√∂nliche Entwicklung</MenuItem>
            <MenuItem value="general">üåü Allgemein</MenuItem>
          </TextField>

          {selectedCategory === 'dating' && (
            <TextField
              select
              margin="dense"
              label="Dating-Bereich"
              fullWidth
              variant="outlined"
              value={selectedDatingType}
              onChange={(e) => setSelectedDatingType(e.target.value)}
              sx={{
                mb: 3,
                '& .MuiOutlinedInput-root': {
                  color: 'white',
                  '& fieldset': {
                    borderColor: 'rgba(255,255,255,0.3)',
                  },
                  '&:hover fieldset': {
                    borderColor: 'rgba(255,255,255,0.5)',
                  },
                  '&.Mui-focused fieldset': {
                    borderColor: '#8b5cf6',
                  },
                },
                '& .MuiInputLabel-root': {
                  color: 'rgba(255,255,255,0.7)',
                  '&.Mui-focused': {
                    color: '#8b5cf6',
                  },
                },
              }}
            >
              <MenuItem value="first-date">ü•∞ Erstes Date</MenuItem>
              <MenuItem value="relationship">üíë Beziehung</MenuItem>
              <MenuItem value="communication">üí¨ Kommunikation</MenuItem>
              <MenuItem value="intimacy">üî• Intimit√§t</MenuItem>
            </TextField>
          )}

          {selectedCategory === 'business' && (
            <TextField
              select
              margin="dense"
              label="Business-Bereich"
              fullWidth
              variant="outlined"
              value={selectedDatingType}
              onChange={(e) => setSelectedDatingType(e.target.value)}
              sx={{
                mb: 3,
                '& .MuiOutlinedInput-root': {
                  color: 'white',
                  '& fieldset': {
                    borderColor: 'rgba(255,255,255,0.3)',
                  },
                  '&:hover fieldset': {
                    borderColor: 'rgba(255,255,255,0.5)',
                  },
                  '&.Mui-focused fieldset': {
                    borderColor: '#8b5cf6',
                  },
                },
                '& .MuiInputLabel-root': {
                  color: 'rgba(255,255,255,0.7)',
                  '&.Mui-focused': {
                    color: '#8b5cf6',
                  },
                },
              }}
            >
              <MenuItem value="career">üöÄ Karriere & Entwicklung</MenuItem>
              <MenuItem value="marketing">üìà Marketing & Verkauf</MenuItem>
              <MenuItem value="entrepreneurship">üí° Unternehmertum</MenuItem>
              <MenuItem value="teamwork">üë• Teamarbeit</MenuItem>
            </TextField>
          )}

          {selectedCategory === 'career' && (
            <TextField
              select
              margin="dense"
              label="Karriere-Bereich"
              fullWidth
              variant="outlined"
              value={selectedDatingType}
              onChange={(e) => setSelectedDatingType(e.target.value)}
              sx={{
                mb: 3,
                '& .MuiOutlinedInput-root': {
                  color: 'white',
                  '& fieldset': {
                    borderColor: 'rgba(255,255,255,0.3)',
                  },
                  '&:hover fieldset': {
                    borderColor: 'rgba(255,255,255,0.5)',
                  },
                  '&.Mui-focused fieldset': {
                    borderColor: '#8b5cf6',
                  },
                },
                '& .MuiInputLabel-root': {
                  color: 'rgba(255,255,255,0.7)',
                  '&.Mui-focused': {
                    color: '#8b5cf6',
                  },
                },
              }}
            >
              <MenuItem value="career">üöÄ Karriereplanung</MenuItem>
              <MenuItem value="job-search">üîç Jobsuche</MenuItem>
              <MenuItem value="skills">üéØ F√§higkeiten entwickeln</MenuItem>
              <MenuItem value="networking">ü§ù Networking</MenuItem>
            </TextField>
          )}

          {selectedCategory === 'leadership' && (
            <TextField
              select
              margin="dense"
              label="Leadership-Bereich"
              fullWidth
              variant="outlined"
              value={selectedDatingType}
              onChange={(e) => setSelectedDatingType(e.target.value)}
              sx={{
                mb: 3,
                '& .MuiOutlinedInput-root': {
                  color: 'white',
                  '& fieldset': {
                    borderColor: 'rgba(255,255,255,0.3)',
                  },
                  '&:hover fieldset': {
                    borderColor: 'rgba(255,255,255,0.5)',
                  },
                  '&.Mui-focused fieldset': {
                    borderColor: '#8b5cf6',
                  },
                },
                '& .MuiInputLabel-root': {
                  color: 'rgba(255,255,255,0.7)',
                  '&.Mui-focused': {
                    color: '#8b5cf6',
                  },
                },
              }}
            >
              <MenuItem value="leadership">üëë F√ºhrungsstil</MenuItem>
              <MenuItem value="team-management">üë• Team-Management</MenuItem>
              <MenuItem value="decision-making">üéØ Entscheidungsfindung</MenuItem>
              <MenuItem value="communication">üí¨ F√ºhrungskommunikation</MenuItem>
            </TextField>
          )}

          <TextField
            margin="dense"
            label="Deine Frage oder dein Anliegen"
            fullWidth
            multiline
            rows={4}
            variant="outlined"
            value={newReadingQuestion}
            onChange={(e) => setNewReadingQuestion(e.target.value)}
            placeholder={selectedCategory === 'dating' ? 
              "z.B. Wie kann ich beim ersten Date authentisch sein?" : 
              "Beschreibe dein Anliegen oder deine Frage..."
            }
            sx={{
              '& .MuiOutlinedInput-root': {
                color: 'white',
                '& fieldset': {
                  borderColor: 'rgba(255,255,255,0.3)',
                },
                '&:hover fieldset': {
                  borderColor: 'rgba(255,255,255,0.5)',
                },
                '&.Mui-focused fieldset': {
                  borderColor: '#8b5cf6',
                },
              },
              '& .MuiInputLabel-root': {
                color: 'rgba(255,255,255,0.7)',
                '&.Mui-focused': {
                  color: '#8b5cf6',
                },
              },
            }}
          />
        </DialogContent>
        <DialogActions sx={{ p: 3 }}>
          <Button
            onClick={() => setNewReadingDialog(false)}
            sx={{ color: 'rgba(255,255,255,0.7)' }}
          >
            Abbrechen
          </Button>
          <Button
            onClick={createNewReading}
            variant="contained"
            sx={{
              background: 'linear-gradient(45deg, #8b5cf6, #a855f7)',
              '&:hover': {
                background: 'linear-gradient(45deg, #7c3aed, #9333ea)',
              }
            }}
          >
            Reading erstellen
          </Button>
        </DialogActions>
      </Dialog>
    </Box>
    </AccessControl>
  );
}

export default ReadingPage;
